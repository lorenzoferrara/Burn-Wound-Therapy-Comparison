---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	fig.align = "center",
	warning = FALSE,
	cache = TRUE,
	include = FALSE,
	echo = FALSE,
	out.width = "70%",
	tidy = TRUE,
	tidy.opts = list(width.cutoff = 50)
)
knitr::opts_chunk$set(out.width = '70%')
knitr::opts_chunk$set(fig.align = "center")
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=50), tidy=TRUE)
library(knitr)
library(rms)
library(survival)
```

```{r}
burn <- read.table("Burn.txt", skip = 32)
  
colnames(burn) = c("treatment", "gender", "burn.percentage", "head", "buttock", "torso", "upper.leg", "lower.leg", "respiratory.system", "burn.type", "time", "cens")

burn$gender = factor( burn$gender, levels = c(0,1), labels=c("Man", "Woman"))
burn$treatment = factor( burn$treatment, levels = c(0,1), labels=c("bathing care", "body cleansing"))
burn$burn.type = factor( burn$burn.type, levels = c(1, 2, 3, 4), labels=c("Chemical", "Scalding", "Electrical", "Flame"))

for(i in c(4:9))
  burn[,i] = as.factor(burn[,i])

head(burn)

# https://en.wikipedia.org/wiki/Detoxification_(alternative_medicine))

```

## 1) Introduction

### Description of the problem

It is generally known that infection is the chief reason for death and morbidity after burn injury, with it being responsible for 51% of the deaths, especially in the first 24 hours. 
<!-- (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4790211/) -->

Indeed burn wounds lack epidermis and circulation, so they are the best culture media for bacterial growth. A few hours after the burn (normally 4-5 hours after) the wound surface becomes contaminated with many bacterial flora, which will start to grow and multiply, reaching the vascular and lymphatic vessels and starting to disperse. At this point, bacteraemia and sepsis start.
However, due to the release of several cell mediators, burn patients have deficiencies in their immune system and cannot tolerate this invasion so, if not treated properly, septic shock, multiple organ failure and most probably death will follow.
<!-- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5946749/ -->

Usually the most frequent bacteria found in burn wound culture are Staphylococcus (55%), Pseudomonas aeruginosa (14.29%), Enterococcus (12.24%), Escherichia coli (4%), Klebsiella and Proteus (both 2%).

Burn severity and the extent of burn injury are major risk factors for the development of infection in burn patients. As a matter of fact burns that involve a larger surface area of the body and burns that are deeper or more severe are more likely to become infected.

### Goals 

Our goal is to study how two treatments, a standard one (bathing care) and an alternative one (body cleansing), affect the time until a Staphylococcus infection.

The second one can be considered part of the *detoxification* practices, a series of alternative medicine systems whose purpose is the one to perform a physiological or medicinal removal of toxic substances from a living organism.

This study will focus on

long time effect of an infection which has not been adequately treated or has not been treated on time.

<!-- In the following report, the different variables will be analyzed, with their influence on the -->
<!-- survival function of the patients in the study. We will evaluate the impact the different -->
<!-- measures have on the health condition of the patients to conclude which are the most crucial -->
<!-- aspects to ensure the longest survival time. -->

## 2) Descriptive analysis

First it's important to point out that 69% of the dataset consists of censored observations, which might lead to a lower accuracy and effectiveness of the result of our analyses.

```{r}
round(sum(burn$cens==0)/length(burn$cens)*100, 0)
```

```{r ggpairs_sise, out.width="90%", fig.align='center'}
# library(ggplot2)
# library(GGally)
# 
# my_dens <- function(data, mapping, ...) {
#   ggplot(data = data, mapping=mapping) +
#     geom_density(..., mapping = ggplot2::aes(color = treatment, alpha = 0.7), fill=NA) 
# }
# 
# ggpairs(
#   burn[,],
#   mapping = ggplot2::aes(color = treatment, alpha = 0.8),
#   diag = list(continuous = my_dens),
#   upper = list(continuous = wrap("density", alpha = 0.5), combo = "box_no_facet"),
#   lower = list(continuous = wrap("points", alpha = 0.3), combo = wrap("dot_no_facet", alpha = 0.4)),
#   title = ""
# )
```


Let's start our preliminary analyses observing how our data are distributed:

DA METTER IN UN MFROW(2,2), MA GGPLOT FA LE BIZZE
```{r}
library(ggplot2)
library(dplyr)
library(patchwork)
library(gridExtra)

#BURN TYPE
df <- burn %>%
  group_by(burn.type) %>%
  summarise(frequency = n())

plot1 = ggplot(df, aes(x = burn.type, y = frequency)) +
  geom_bar(fill = c("green3", "#0073C2FF", "yellow2", "red3"), stat = "identity") +
  geom_text(aes(label = frequency), vjust = -0.3) +
  xlab("Type of burn")


#GENDER
df <- burn %>%
  group_by(gender) %>%
  summarise(frequency = n())

plot2 = ggplot(df, aes(x = gender, y = frequency)) +
  geom_bar(fill = c("#0073C2FF", "salmon2"), stat = "identity") + 
  geom_text(aes(label = frequency), vjust = -0.3) +
    xlab("Gender")


#TREATMENT
df <- burn %>%
  group_by(treatment) %>%
  summarise(frequency = n())

plot3 = ggplot(df, aes(x = treatment, y = frequency)) +
  geom_bar(fill = c("royalblue", "orange2"), stat = "identity") + 
  geom_text(aes(label = frequency), vjust = -0.3) +
    xlab("Treatment")



#BURN PERCENTAGE
binwidth = 4.5
plot4 = ggplot(burn, aes(x=burn.percentage)) + 
  geom_histogram(color="black", fill= heat.colors(round(100/binwidth), rev = T), binwidth = binwidth) +
    xlab("Total percentage of burns")

#BODY AREA
df = data.frame( area = c("head", "buttock", "torso", "upper.leg", "lower.leg", "Respiratory.system"), frequency = c(sum(burn$head==1), sum(burn$buttock==1), sum(burn$torso==1), sum(burn$upper.leg==1), sum(burn$lower.leg==1), sum(burn$respiratory.system==1)) )

plot5 = ggplot(df, aes(x = area, y = frequency)) +
  geom_bar(fill = "#0073C2FF", stat = "identity") +
  geom_text(aes(label = frequency), vjust = -0.3) +
    xlab("Part of the body burnt")

grid.arrange(plot1, plot2, plot3, plot4, plot5, ncol=3)
```

And then we investigate about the correlation among themselves:

```{r}
par(mfrow=c(1,2))
for (i in c(1:2,4:10))
boxplot(burn$time ~ burn[,i], main=names(burn)[i], ylab = "time", xlab="")

i=3
plot(burn[,i], burn$time, xlab=names(burn)[i], ylab="time", ylim=c(0,100))
```

```{r}
p=c()
for(i in c(2, 4:9)){
  p= c(p, t.test(burn$time ~ burn[,i])$p.value)
}
p

p<0.05
keep = p<0.05
names(burn)

names(burn)[keep]
```


```{r eval=FALSE, warning=FALSE, include=FALSE}
# source: https://stackoverflow.com/questions/52554336/plot-the-equivalent-of-correlation-matrix-for-factors-categorical-data-and-mi
df = burn[, 1:11]

library(tidyverse)
library(lsr)

# function to get chi square p value and Cramers V
f = function(x,y) {
    tbl = df %>% select(x,y) %>% table()
    chisq_pval = round(chisq.test(tbl)$p.value, 4)
    cramV = round(cramersV(tbl), 4) 
    data.frame(x, y, chisq_pval, cramV) }

# create unique combinations of column names
# sorting will help getting a better plot (upper triangular)
df_comb = data.frame(t(combn(sort(names(df)), 2)), stringsAsFactors = F)

# apply function to each variable combination
df_res = map2_df(df_comb$X1, df_comb$X2, f)

# plot results
df_res %>%
  ggplot(aes(x,y,fill=chisq_pval))+
  geom_tile()+
  geom_text(aes(x,y,label=round(cramV, digits = 2)))+
  scale_fill_gradient(low="red", high="yellow")+
  theme_classic()

```

```{r}
library(ltm)

biserial.cor(burn$time, burn$treatment)
biserial.cor(burn$time, burn$gender)
biserial.cor(burn$time, burn$head)
biserial.cor(burn$time, burn$buttock)
biserial.cor(burn$time, burn$torso)
biserial.cor(burn$time, burn$upper.leg)
biserial.cor(burn$time, burn$lower.leg)
biserial.cor(burn$time, burn$respiratory.system)

# biserial.cor(burn$time, burn$burn.type)

```



## 3) Nonparametric analysis

The overall survival function is

```{r include = T}
svf <- survfit(Surv(time, cens) ~ 1, burn)

par(las = 1, font = 2, font.axis = 2, font.lab = 4, bty = "l", mar = c(5, 5, 4, 2))
plot(svf, lwd = 2, col=c(1,2,2), xlab = "Survival time [Days]",
     ylab = expression(bolditalic(hat(S)(t))), xaxs = "i", yaxs = "i", mark.time = F)
abline(h=0.5, lty=2)
title("Survival function")
```

```{r}
temp = min(which(svf$surv<=0.5))
med_surv_time = svf$time[temp]
```

and the median survival time is `r med_surv_time` days.

But if we observe the survival function for different levels of the categorical covariates we can notice very different patterns.

Since we want to study the effect of the two treatments on the patients, we'll study their effect both individually and in combination with the other covariates.

```{R}
svf <- npsurv(Surv(time, cens) ~ treatment, burn)

par(font = 2, font.axis = 2, font.lab = 4, las = 1, mar = c(5, 5, 4, 2))
survplot(svf, ylab = expression(bold(hat(S)(t))), col = 1:2, lwd = 3, xlab="Survival time [Days]")
title("Survival functions according to treatment")
abline(h=0.5, lty=2)
```

```{r}
formula = with(burn, Surv(time, cens) ~ treatment)

library(FHtest)
FHtestrcc(formula, rho = 1, lambda = 1)
```

<!-- - treatment: -->
<!-- For both treatment groups the survival function behaves similarly for the first 5 years, then -->
<!-- they move apart a little, with ddc treatment having a higher survival probability until the -->
<!-- end of the study when both functions reach approximately the same level. The log-rank test, -->
<!-- used on both groups shows the same result, with Chi-sq= 2.1 on 1 degree of freedom, we -->
<!-- receive p= 0.2. Therefore, there is no significant difference to be found in the behavior of -->
<!-- both survival functions. -->

**Treatment**

We can immediately appreciate a difference of the survival function in the two treatments. They are stochastically ordered, with *body cleansing* being generally more effective than *bathing care* in fighting or delaying the insurgence of Staphylococcus infection. They are both quite smooth and stabilize respectively on the  value 0.662 and 0.404 after 51 days.
Therefore, to test the difference between these two survival functions we perform a Fleming-Harrington test with $\rho=1$ and $\lambda=1$. This test (with $pvalue=0.4$) confirms at level 5% that there is a significant difference in the central part of the infection process.

```{r}
#GENDER
n=length(levels(burn$gender))
svf <- survfit(Surv(time, cens) ~ gender + treatment, burn)
svf1 <- survfit(Surv(time, cens) ~ gender, burn)

names=c()
for(i in 1:n){
  for(j in 1:2){
    names=c(names, paste(levels(burn$gender)[i], " receiving ", levels(burn$treatment)[j], sep=""))
  }
}

par( mfrow=c(1,2), las = 1, font = 2, font.axis = 2, font.lab = 4, bty = "l",
    mar = c(5, 5, 4, 2))

#UNIVARIATE
plot(svf1, col = 1:n, lty = c(rep(1, n), rep(2, n)), lwd = 3, xlab = "Survival time [Days]",
     ylab = expression(bolditalic(hat(S)(t))), xaxs = "i", yaxs = "i", mark.time = F)
abline(h=0.5, lty=2)
legend("bottomleft", levels(burn$gender), lwd = 3, col = 1:n, lty = c(rep(1, n), rep(3, n)), bty = "n", cex=0.8)
# title( paste("Survival functions according to gender" ))

#BIVARIATE
plot(svf, lty = 1:n, col = c(rep(1, n), rep(2, n)), lwd = 3, xlab = "Survival time [Days]",
     ylab = expression(bolditalic(hat(S)(t))), xaxs = "i", yaxs = "i", mark.time = F)
abline(h=0.5, lty=2)
legend("bottomleft", names, lwd = 3, lty = c(1,3), col = c(rep(1, n), rep(2, n)), bty = "n", cex=0.8)
# title( paste("Survival functions according to gender" ))

mtext("Survival functions according to gender", side = 3, line = -2, outer = TRUE)

```

**Gender**

Comparing the survival functions of men and women we notice that women show an overall higher survival probability, even though the two curves meet at around 40 days. We have also studied this trend through a bivariate analysis, dividing the observations both by gender and by treatment. This approach confirms a generally higher survival probability in women with respect to men and a remarkable difference in the two treatments, especially in the long term, to the point that men receiving *bathing care* reach $\hat{S}(t)=0.16$ after 51 days.
However, if we perform a Logrank test on the gender variable
$$ \begin{cases} H_0: S_{men}(t)=S_{women}(t) \\ H_1: S_{men}(t) \neq S_{women}(t)  \end{cases} $$
we get a $\chi^2$ statistic of 2.4 on 1 degree of freedom, giving us a p-value of $0.1$. Therefore, we don't have enough evidence to say that the survival times for male and female patients are different.

```{r}
formula = with(burn, Surv(time, cens) ~ gender)
survdiff(formula)
```

**Body parts**

We have then studied the influence of the location of the burn on the observed survival times.
In almost all of these variables a graphical analysis suggests that the differences could be considered negligible, since the survival functions tend to overlap or follow very similar patterns. Only in the buttock variable we find a diverging pattern from day 0 to day 51, when the curves cross and remain quite close.

To corroborate this hypothesis we proceed to perform Logrank tests on these variables:

$$ \begin{cases} H_0: S_0(t)=S_1(t) \\ H_1: S_0(t) \neq S_1(t)  \end{cases} $$

It is probably relevant to remind the reader that the aim of this study is to analyse the treatments' effects in relation to the available covariates; however in this case no stratified test has been performed since the groups were quite balanced (maybe due to a particular design of the experiment), meaning that the two treatments were present in an approximately equal number of cases throughout the study of all the variables.

The tests are all not significant, most of them with very high p-values (in the range $[0.45, 0.73]$). It is interesting to point out that buttock is the one with the smallest pvalue ($0.27$), resulting the most significant among the location variables.

```{r}
pvalues=c()

formula = with(burn, Surv(time, cens) ~ head)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

formula = with(burn, Surv(time, cens) ~ torso)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

formula = with(burn, Surv(time, cens) ~ buttock)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

formula = with(burn, Surv(time, cens) ~ upper.leg)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

formula = with(burn, Surv(time, cens) ~ lower.leg)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

formula = with(burn, Surv(time, cens) ~ respiratory.system)
pvalues = c(pvalues, 1 - pchisq(survdiff(formula)$chisq, 1))

df = data.frame(body_part = c("head","torso", "buttock", "upper_leg","lower_leg", "respiratory_system"), pvalue = pvalues)
df
```


```{r include=T}
#burn.type
n=length(levels(burn$burn.type))
svf <- survfit(Surv(time, cens) ~ burn.type + treatment, burn)
svf1 <- survfit(Surv(time, cens) ~ burn.type, burn)

names=c()
for(i in 1:n){
  for(j in 1:2){
    names=c(names, paste("burn.type=", levels(burn$burn.type)[i], " and treatment=", levels(burn$treatment)[j], sep=""))
  }
}

par( las = 1, font = 2, font.axis = 2, font.lab = 4, bty = "l",
    mar = c(5, 5, 4, 2))

#UNIVARIATE
plot(svf1, col = 1:n, lty = c(rep(1, n), rep(2, n)), lwd = 3, xlab = "Survival time [Days]",
     ylab = expression(bolditalic(hat(S)(t))), xaxs = "i", yaxs = "i", mark.time = F)
abline(h=0.5, lty=2)
legend("bottomleft", levels(burn$burn.type), lwd = 3, col = 1:n, lty = c(rep(1, n), rep(3, n)), bty = "n", cex=0.8)
title( paste("Survival functions according to burn type" ))


# mtext("Survival functions according to burn type", side = 3, line = -2, outer = TRUE)
```

**Burn type**

Finally, we have compared the severity of the different kinds of burn, *Chemical*, *Scalding*, *Electrical* and *Flame*. 

- The Scalding burn and the Electrical one seem to be the most critical ones in the first days after the accident with the Scalding reaching $\hat{S}(t)=0.667$ after 7 days and the Electrical reaching $\hat{S}(t)=0.436$ after only 13 days (very little compared to the median survival time of `r med_surv_time` days).
- The burn type with the highest survival probability is the Chemical, however this level has only one uncensored observation so we do not enough data to make a fair comparison between the groups. 
- Lastly, the Flame burn shows a smoother trend, reaching $\hat{S}(t)=0.473$ after 51 days.
In general this variable presents quite diverse patterns. This is can be confirmed through a Logrank test: 
$$ \begin{cases} H_0: S_{Chemical}(t)=S_{Scalding}(t)=S_{Electrical}(t)=S_{Flame}(t) \\ H_1: \exists \space i,j \text{ s.t. } S_i(t) \neq S_j(t)  \end{cases} $$

```{r}
formula = with(burn, Surv(time, cens) ~ burn.type)
survdiff(formula)
```

## 4) Fit of a parametric survival model

### Fit of a Weibull, log-logistic, or lognormal model.

<!-- After observing that all the variables corresponding to the locations of the burn (except for the buttock indicator variable) were not significant -->

We'll fit the Weibull model:
$$Y = \ln T = \mu + \gamma_1\cdot treatment + \gamma_2\cdot gender + \gamma_3\cdot head + \gamma_4\cdot buttock + \gamma_5\cdot torso + \gamma_6\cdot upper \textunderscore leg$$ 
$$+ \gamma_7\cdot lower \textunderscore leg + \gamma_8\cdot respiratory \textunderscore system + \gamma_9\cdot burn \textunderscore type + \gamma_{10}\cdot burn\textunderscore percentage + \sigma \cdot W$$ 

```{r}
#Weibull
surv = with(burn, Surv(time, cens))
```

Then we decide to apply a step-wise feature selection and reduce the model to a simpler one, using as classifying criterion the AIC
$$AIC = 2k - 2\ln(\text{maxLikelihood}), \text{ with } k=\text{n° of variables}$$
which estimates the trade-off between the goodness of fit of the model and its simplicity.

The new model obtained is:
$$Y = \ln T = \mu + \gamma_1\cdot treatment + \gamma_2\cdot gender + \gamma_4\cdot buttock + \gamma_9\cdot burn \textunderscore type + \sigma \cdot W$$ 

We can notice how this result is somehow coherent with the tests we have previously performed on the survival times since both approaches have led to keeping and discarding the same sets of variables. /
The same set of variable is kept after following the same procedure for a Log-logistic model. Therefore we consider ourselves satisfied with this feature selection phase and we can now proceed to inspect the residuals of the two models.

```{r}
weib_fit = survreg(surv ~ treatment + gender + buttock + burn.type, data = burn)
weib_pred <- predict(weib_fit, type = "linear")
weib_resids <- (log(burn$time) - weib_pred) / weib_fit$scale

survgumb <- function(x) {     #theoretical survival function
  return(exp(-exp(x)))
}
```

```{r}
loglog_fit = survreg(surv ~ treatment + gender + buttock + burn.type, data = burn, dist = "loglogistic")
loglog_pred <- predict(loglog_fit, type = "linear")
loglog_resids <- (log(burn$time) - loglog_pred) / loglog_fit$scale

logistic <- function(x) {  #theoretical survival function
  return(1/(1+exp(x)))
}
```

```{r include = T}
par(mfrow=c(1,2), font = 2, font.lab = 4, font.axis = 2, las = 1, oma = c(0, 0, 1, 0), mar = c(4.8, 5, 2.5, 2))

#WEIBULL
plot(survfit(Surv(weib_resids, burn$cens) ~ 1), xlab = "days", lwd = 2, ylab = expression(bold(hat(S)(t))) , yaxs = "i")
title("Weibull model")
curve(survgumb(x), from = min(weib_resids), to = max(weib_resids), col = 2, lwd = 2,
      add = TRUE)
legend("bottomleft", c("Empirical Residuals", "95% C.I.", "Stand. Gumbel Distribution"),
       col = c(1, 1, 2), lty = c(1, 2, 1), lwd = 3, bty = "n", cex=0.85)

#LOGLOGISTIC
plot(survfit(Surv(loglog_resids, burn$cens) ~ 1), xlab = "days", lwd = 2, ylab = expression(bold(hat(S)(t))) , yaxs = "i")
title("Log-logistic model")
curve(logistic(x), from = min(loglog_resids), to = max(loglog_resids), col = 2, lwd = 2,
      add = TRUE)
legend("bottomleft", c("Empirical Residuals", "95% C.I.", "Stand. Logistic Distribution"),
       col = c(1, 1, 2), lty = c(1, 3, 1), lwd = 3, bty = "n", cex=0.85)
```

From a graphical analysis, in both the models the residuals seem to resemble quite much the theoretical ones, with almost all of the functions being inside the confidence intervals. Nonetheless we can notice how the Log-logistic model seems to have a slightly better behavior, being completely inside the intervals and closer to the empirical survival function.

This is also confirmed by the comparison of the logLikelihood of the models, with the Log-logistic having the highest value.

```{r include = T}
df = data.frame(distribution = c("Weibull", "Log-logistic"), Loglikelihood = c(weib_fit$loglik[2], loglog_fit$loglik[2]))
df
```

Therefore we choose the Log-logistic model as the optimal one to describe our phenomenon and we proceed to interpret it.

### Interpretation of the model fit.

It is known that a Log-logistic model can be written as a proportional odds model with respect to a baseline $Z=0$ as:
$$\frac{S(t|Z)}{1-S(t|Z)} = \exp(\frac{\gamma'Z}{\sigma}) \cdot \frac{S(t|Z=0)}{1-S(t|Z=0)}$$

So that $\exp(\frac{\gamma_i Z_i}{\sigma})$ can be interpreted as the Odds Ratio between the $i^{th}$ covariate and the baseline: Man who received a burn of type *Chemical*.\
While the general expression of the accelerating factor for a single variable $Z_i$ is $AF = e^{\gamma_i Z_i}$


allows a representation as a proportional odds (PO) model.

```{r}
df = data.frame(gamma = coef(loglog_fit), OR = exp(coef(loglog_fit)/loglog_fit$scale), AFT = exp(-coef(loglog_fit)))[-1,]
df
```

The Odds Ratio represents the ratio of the odds of an event occurring in one group to the odds of the event
occurring in another group. \
In our case we can observe how, for each time t, the odds of surviving under the alternative treatment (body cleansing) are 2.37 times larger than the ones under the standard treatment (bathing care), confirming the considerations made above about the effectiveness of such treatments.\
In the same way we can infer that, according to the model, the surviving odds for a woman are more than double the odds of a woman (precisely 2.25).\
In addition, thanks to the low OR in the buttock variable ($OR=0.44$) we can identify it as a **risk factor**: a person who burns himself on his buttock can see his survival odds reduced by almost half. \
Finally, comparing the Odds Ratios of the burn type variable, we can once again confirm how grave an Electrical burn is with respect to the other types (with its odds being 5% of the chemical odds, 24% of the scalding odds and 17% of the flame odds). The Chemical reaffirms itself as the less dangerous, while Scalding and Flame can be deemed to be of almost comparable risk. 

Analogous conclusions can be drawn by analyzing the Acceleration Factor since it indicates how the lifespan of an individual is accelerated or decelerated by a specific covariate. In particular if $AF_i<1$, this means that the covariate is extending the survival time.
Therefore we'll deduce that both being woman and using the alternative treatment will almost double the lifespan, while burning himself in the buttock and undergoing a Scalding/Electrical/Flame burn will reduce the lifespan respectively by a factor of 2, 4, 15 and 3.  

## 5) Fit of a semi-parametric model

### Fit of the proportional hazards models.

### Interpretation of the model fit.

### Interpretation of the model parameters in terms of relative hazards.

### Analysis of the residuals to check the model’s goodness-of-fit.

## 6) Conclusions

<!-- The report can be wrien in either Catalan, Spanish, or English and it should comprise approximately -->
<!-- 10 to 12 pages with a maximum number of ve tables and ve gures. Half a point is given for a good -->
<!-- presentation of the work. -->

